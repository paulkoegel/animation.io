var Actor=function(a,b,c,d,f){this.startAnimationTimestamp=now();this.resetStartAnimationTimestamp=function(){this.startAnimationTimestamp=now()};this.startPosition={x:b,y:c};this.vector={x:0,y:0};this.tilt=this.spin=0;this.behaviors=[];this.reactions=[];this.reactionTargets=[];this.phases=[];this.oldPhase=0;this.phaseCycle=1E3;this.waitingForReset=this.doesReset=!1;this.waitingForResetSince=null;this.lastVisibilityCheckInSeconds=now();this.currentOpacity=1;this.currentlyVisible=!0;this.originalOpacity=
1;this.delay=this.originaldelay=0;this.enteredAt=this.scene=null;this.navigatesOnTouch=function(a){this.reacts("window.animation.showScene('"+a+"')",0);this.image.className+="navigation";this.scene.preloadSceneIds.push(a)};this.loadsOnTouch=function(a){this.reacts("window.animation.fadeToScene('"+a+"')",0);this.image.className+="navigation"};this.delays=function(a){this.delay=this.originaldelay=a};this.age=function(){return now()-this.startAnimationTimestamp};this.alterOpacity=function(a){a!=this.currentOpacity&&
(this.currentOpacity=a,this.image.style.opacity=this.currentOpacity,this.image.style.filter="alpha(opacity="+100*this.newOpacity+")")};this.setInitialOpacity=function(a){this.originalOpacity=a;this.alterOpacity(a)};this.setInvisible=function(){this.image.style.visibility="hidden";this.currentlyVisible=!1};this.setVisible=function(){this.image.style.visibility="";this.currentlyVisible=!0};this.resets=function(a){this.doesReset=!0;"undefined"===typeof a&&(a=0);this.resetDelay=a};this.resetReactions=
function(){for(var a=0;a<this.reactions.length;a++)this.reactions[a].reset()};this.resetBehaviors=function(){for(var a=0;a<this.behaviors.length;a++)this.behaviors[a].reset()};this.reset=function(){this.resetBehaviors();this.resetReactions();this.image.src="images/"+this.image.originalPath;this.resetStartAnimationTimestamp();this.position={x:b,y:c};this.vector={x:0,y:0};this.lastVector={x:0,y:0};this.setSize(d,f);this.setInitialOpacity(this.originalOpacity);this.delay=this.originaldelay;this.finishedDelaying=
!1;this.startedDelayingAt=null;this.tilt=0;moveActor(this);tiltActor(this)};this.removeBehaviorsThatCameFromReacts=function(){for(var a=[],b=this.behaviors.length-1;0<=b;b--)this.behaviors[b].triggeredByAction||a.push(this.behaviors[b]);this.behaviors.length!=a.length&&(this.behaviors=a)};this.setSize=function(a,b){this.imagesize={x:a,y:b};this.image.style.width=a+"px";this.image.style.height=b+"px"};this.enter=function(a){a.div.appendChild(this.image);this.enteredAt=now()};this.addBehavior=function(a){try{a.reset()}catch(b){}this.behaviors.push(a)};
"undefined"!=typeof delay&&(this.delay=parseInt(delay),this.startedDelayingAt=null,this.finishedDelaying=!1);this.addPhase=function(a){document.createElement("img").setAttribute("src","images/"+a);this.phases.push("images/"+a)};this.setPhaseCycleLength=function(a){this.phaseCycle=a};this.currentPhase=function(){var a=0,b=this.phases.length;if(1<b)var a=now()-this.enteredAt,c=this.phaseCycle/b,a=parseInt(a%(b*c)/c);return a};this.setup=function(){this.image=document.createElement("img");this.image.originalPath=
a;this.filename=a.substring(a.lastIndexOf("/")+1);this.image.setAttribute("src","images/"+this.image.originalPath);this.image.actor=this;this.phases.push("images/"+a);this.position={x:b,y:c};this.setSize(d,f);this.vector={x:0,y:0};bindEvent(this.image,"mousedown",function(){this.actor.react()});moveActor(this)};this.setup()};
function moveActor(a){a.position.x+=a.vector.x;a.position.y+=a.vector.y;a.image.style.left=a.position.x+"px";a.image.style.top=a.position.y+"px";a.lastVector=a.vector;a.vector={x:0,y:0}}function tiltActor(a){a.tilt=(a.tilt+a.spin)%360;a.image.style.transform="rotate("+a.tilt+"deg)";a.image.style.webkitTransform="rotate("+a.tilt+"deg)";a.image.style.msTransform="rotate("+a.tilt+"deg)";a.image.style.OTransform="rotate("+a.tilt+"deg)";a.spin=0}function visibleOnStage(){return!notVisibleOnStage}
function notVisibleOnStage(a){return a.position.x>a.scene.dimensions.x||0>a.position.x+a.imagesize.x||0>a.position.y+a.imagesize.y||a.position.y>a.scene.dimensions.y}
function animateactor(a){if(a.doesReset&&notVisibleOnStage(a))a.waitingForReset?t()-a.waitingForResetSince>=a.resetDelay&&(a.reset(),a.waitingForReset=!1):a.doesReset&&(a.alterOpacity(0),a.waitingForReset=!0,a.waitingForResetSince=t());else if(0<a.delay&&!a.finishedDelaying)null==a.startedDelayingAt?a.startedDelayingAt=t():t()>=a.startedDelayingAt+a.delay&&(a.finishedDelaying=!0);else{1<a.phases.length&&a.currentPhase()!=a.oldPhase&&(a.image.src=a.phases[a.currentPhase()],a.oldPhase=a.currentPhase());
for(var b=0;b<a.behaviors.length;b++)a.behaviors[b].applybehavior();(0!=a.vector.x||0!=a.vector.y)&&moveActor(a);0!=a.spin&&tiltActor(a)}};var developermode=!1;
function Animation(a,b,c,d,f,g,e){config(this);this.firstSceneId=c;this.loadedScenes=[];this.stageDiv=createDiv("stage","stage");this.stageDiv.style.width=a+"px";this.stageDiv.style.height=b+"px";this.width=a;this.height=b;this.textIsDisplaying=!0;this.minWidth="undefined"==typeof d?this.width:d;this.maxWidth="undefined"==typeof f?this.width:f;this.minHeight="undefined"==typeof g?this.height:g;this.maxHeight="undefined"==typeof e?this.height:e;this.startAnimationTimestamp=now();this.age=function(){return now()-
this.startAnimationTimestamp};this.scaleToWindow=function(){var a=window.innerWidth,b=window.innerHeight,c=b,d=a,e=window.innerWidth/window.innerHeight,f=this.width/this.height;if(0!=this.minWidth&&f>e){a<this.minWidth?a=this.minWidth:a>this.maxWidth&&(a=this.maxWidth);var g=a/this.width,c=a*g}else 0!=this.minWidth&&(b<this.minHeight?b=this.minHeight:b>this.maxHeight&&(b=this.maxHeight),g=b/this.height,d=b*g);1!=g&&rescale(this.stageDiv,g);window.animationwrapper.style.marginTop=(window.innerHeight-
parseInt(this.height*g))/2+"px";window.animationwrapper.style.width=d+"px";window.animationwrapper.style.marginLeft=(window.innerWidth-parseInt(this.width*g))/2+"px";window.animationwrapper.style.height=c+"px"};this.loadScene=function(c){for(var d=this.loadedScenes.length-1;0<=d;d--)if(this.loadedScenes[d].id===c)return this.loadedScenes[d];c=eval(c+"()");c.setDimensions(a,b);this.loadedScenes.push(c);this.stageDiv.appendChild(c.div);c.makeInvisible();return c};this.fadeToScene=function(a){a=parseInt(/scene(\d+)/.exec(a)[1],
10);window.location.hash=a;fadeOut(window.animationwrapper,600);setTimeout("window.location.reload()",850)};this.showScene=function(a){l("show "+a);if(this.animation.age()>=this.config.maximumAnimationAge)fadeToScene(a);else if("undefined"===typeof this.currentScene||1E3<this.currentScene.age()){this.currentScene=loadScene(a);var b=getIntegerFromEndOfString(a);window.location.hash=0==b?"":b;this.currentScene.enterActors();this.currentScene.resetActors();this.currentScene.makeOthersInvisible();this.currentScene.muteOthers();
this.currentScene.resetAge();this.dropUnneededScenes(this.currentScene.preloadSceneIds);this.loadNeededScenes(this.currentScene.preloadSceneIds);window.forceReloadTimer=setTimeout('fadeToScene("'+a+'")',window.animation.config.maximumAnimationAge)}};this.showFirstScene=function(){this.showScene(this.firstSceneId)};this.loadedSceneIds=function(){for(var a=[],b=this.loadedScenes.length-1;0<=b;b--)a.push(this.loadedScenes[b].id);return a};this.dropUnneededScenes=function(a){for(var a=this.loadedSceneIds().minus(a),
b=a.length-1;0<=b;b--)this.dropScene(a[b])};this.loadNeededScenes=function(a){for(var a=a.minus(this.loadedSceneIds()),b=a.length-1;0<=b;b--)this.loadScene(a[b])};this.dropScene=function(a){for(var b=this.loadedScenes.length-1;0<=b;b--)this.loadedScenes[b].id===a&&(document.getElementById(a),this.stageDiv.removeChild(this.loadedScenes[b].div),this.loadedScenes=this.loadedScenes.without(b))};return this}
function loadAnimation(a,b,c,d,f,g,e,h){compatibleBrowser()?animationLoader(a,b,c,d,f,g,e,h):document.getElementById("backupdiv").style.display="block"}function loadAnimationInto(a,b,c,d,f){b=document.getElementById(b);animationLoader(a,d,f,c,d,d,f,f,b)}
function animationLoader(a,b,c,d,f,g,e,h,i){document.title=a;if(window.onload)var j=window.onload;window.onload=function(){j&&j();setTimeout(function(){window.scrollTo(0,1)},100);window.animation=Animation(b,c,d,f,g,e,h);"undefined"===typeof i?(window.animationwrapper=createDiv("animationwrapper",""),window.document.body.appendChild(window.animationwrapper),window.animationwrapper.appendChild(this.stageDiv),window.animation.scaleToWindow()):(window.animationwrapper=i,window.animationwrapper.appendChild(this.stageDiv));
var a=parseInt(window.location.hash.substring(1));isNaN(a)?window.animation.showScene(d):eval("window.animation.showScene('scene"+a+"')");window.animation.startLoop();fadeIn(window.animationwrapper)};if(window.onresize)var k=window.onresize;window.onresize=function(){k&&k();window.animation.scaleToWindow()}}
requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();function startLoop(){this.animloop=function(){requestAnimFrame(animloop);for(var a=0;a<window.currentScene.actors.length;a++)animateactor(window.currentScene.actors[a])};this.animloop()};Array.prototype.minus=function(a){for(var b=this,c=b.length-1;0<=c;c--)for(var d=a.length-1;0<=d;d--)if(a[d].match(b[c])){b=b.without(c);break}return b};Array.prototype.without=function(a){var b=0<a?this.slice(0,a):[],a=this.slice(a+1);return b.concat(a)};function compatibleBrowser(){var a=navigator.userAgent,b=[];b.push("MSIE 6");b.push("MSIE 7");b.push("MSIE 8");for(var c=!0,d=b.length-1;0<=d;d--)if(0<a.toLowerCase().indexOf(b[d].toLowerCase())){c=!1;break}return c};function bindEvent(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function unbindEvent(a,b){this.removeEventListener("click",arguments.callee,!1)}function getClickPosition(a){var b=document.getElementById("stage");stageX=b.offsetLeft-b.scrollLeft+b.clientLeft;stageY=b.offsetTop-b.scrollTop+b.clientTop;l("click, "+(a.clientX-stageX)+", "+(a.clientY-stageY))}bindEvent(window,"click",getClickPosition);function fadeIn(a,b){if(notNumeric(a.style.opacity)||0>a.style.opacity)a.style.opacity=0;notNumeric(b)&&(b=1E3);prepareFade(a,b,1)}function fadeOut(a,b){if(notNumeric(a.style.opacity)||1<a.style.opacity)a.style.opacity=1;notNumeric(b)&&(b=1E3);prepareFade(a,b,0)}function executeFadeInTimeoutLoop(a,b,c,d,f,g){var e=b+(c-b)/(d/f);1<e||0>e?a.style.opacity=c:(a.style.opacity=e,setTimeout(function(){executeFadeInTimeoutLoop(a,e,c,d-g,f,g)},g))}
function prepareFade(a,b,c){var d=parseFloat(a.style.opacity);executeFadeInTimeoutLoop(a,d,c,b,30,1E3/30)};if(!window.console)var console={log:function(){},warn:function(){},error:function(){},time:function(){},timeEnd:function(){}};function l(a){developermode&&console.log(a)}function truth(a){return"undefined"===typeof a||"undefined"===a?!1:Boolean(a)}function distance(a,b,c,d){return Math.abs(Math.sqrt((c-a)*(c-a)+(d-b)*(d-b)))}function vector(a,b,c,d){var f=distance(a,b,c,d);return{x:(c-a)/f,y:(d-b)/f,distance:f}}function now(){return(new Date).getTime()}function timeInMinutes(a){return 6E4*a}
function seconds(){return parseInt(now()/1E3)}function floatValueOfOr(a,b){return isNumeric(a)?parseFloat(a):b}Number.prototype.subtractUntilZero=function(a){return a>=this?0:this-a};Number.prototype.addUntilTarget=function(a,b){var c=this+a;return c>b?b:c};function isNumeric(a){return!notNumeric(a)}function notNumeric(a){return"undefined"===typeof a||isNaN(parseFloat(a))||!isFinite(a)}function round(a,b){0>b&&(b=0);this.q=Math.pow(10,b);return Math.round(a*this.q)/this.q}
function cutOffPx(a){return parseFloat(a.toString().substring(0,a.length-2))}function createDiv(a,b){var c=document.createElement("div");c.setAttribute("id",a);c.setAttribute("class",b);return c}function t(){return now()}function browserCompatible(){try{return new Audio,!0}catch(a){return!1}}function minutesToTime(a){return 6E4*a}function getIntegerFromEndOfString(a){return parseInt(a.match(/\d+$/)[0])}
function rescale(a,b){a.style.transformOrigin="0 0";a.style.transform="scale("+b+", "+b+")";a.style.msTransformOrigin="0 0";a.style.msTransform="scale("+b+", "+b+")";a.style.webkitTransformOrigin="0 0";a.style.webkitTransform="scale("+b+", "+b+")";a.style.OTransformOrigin="0 0";a.style.OTransform="scale("+b+", "+b+")"};function Plugin(a,b,c,d,f){this.delay=a;this.easeIn="undefined"!=typeof b?b:0;this.needsToCalculateEasein=0<this.easeIn;this.startAnimationTimestamp=new Date;this.triggeredByAction=!1;this.setup=function(){this.actor=c;this.triggeredByAction=truth(d);this.targetObject=isNumeric(f)?c.reactionTargets[f]:c};this.setup();this.resetStartAnimationTimestamp=function(){this.startAnimationTimestamp=now()};this.applybehavior=function(){};this.resetPlugin=function(){this.done=!1;this.resetStartAnimationTimestamp();
this.needsToCalculateEasein=0<this.easeIn};this.isDoneWhen=function(a){this.done=a};this.reset=function(){this.resetPlugin()};this.age=function(){return new Date-this.startAnimationTimestamp};this.factor=function(){if(this.needsToCalculateEasein&&0<this.easeIn&&this.age()<this.easeIn)return Math.cos(this.age()/this.easeIn*(Math.PI/2)-Math.PI/2);this.needsToCalculateEasein=!1;return 1};return this};var Reaction=function(a,b,c){this.actor=a;this.reactioncode=b;this.reactHowOften=c;this.runs=0;if(notNumeric(this.reactHowOften)||0>this.reactHowOften)this.reactHowOften=0;this.reset=function(){0<this.runs&&(this.actor.image.style.cursor="pointer",this.runs=0)};return this};
Actor.prototype.react=function(){for(var a=0;a<this.reactions.length;a++){var b=this.reactions[a];if(0==b.reactHowOften||b.runs<b.reactHowOften)eval(b.reactioncode.replace("reactionTargetIndex",a)),b.runs++,0<b.reactHowOften&&b.runs>=b.reactHowOften&&(this.image.style.cursor="auto")}};Actor.prototype.reacts=function(a,b,c){this.image.style.cursor="pointer";c="undefined"===typeof c?this:c;a=new Reaction(this,a,b,c);this.reactions.push(a);this.reactionTargets.push(c)};
Actor.prototype.reactsOnce=function(a,b){this.image.style.cursor="pointer";var c=new Reaction(this,a,1,"undefined"===typeof b?this:b);this.reactions.push(c)};Actor.prototype.reactsTwice=function(a,b){this.image.style.cursor="pointer";var c=new Reaction(this,a,2,"undefined"===typeof b?this:b);this.reactions.push(c)};function Scene(a,b){this.id=a;this.title="undefined"!=typeof b?b:a;this.div=createDiv(a,"scene");this.stage=null;this.dimensions={x:0,y:0};this.isVisible=!1;this.actors=[];this.texts=[];this.textDisplaying=!0;this.alwaysShowsText=!1;this.displayedAt=Date.now();this.resetAge=function(){return this.displayedAt=Date.now()};this.age=function(){return Date.now()-this.displayedAt};this.alwaysShowText=function(){this.alwaysShowsText=!0};this.preloadSceneIds=[a];this.resetActors=function(){for(var a=this.actors.length-
1;0<=a;a--)this.actors[a].reset()};this.removeBehaviorsThatCameFromReacts=function(){for(var a=this.actors.length-1;0<=a;a--)this.actors[a].removeBehaviorsThatCameFromReacts()};this.setDimensions=function(a,b){this.dimensions={x:a,y:b};this.div.style.width=this.dimensions.x+"px";this.div.style.height=this.dimensions.y+"px"};this.makeVisible=function(){this.div.style.visibility="visible";this.isVisible=!0};this.makeInvisible=function(){this.div.style.visibility="hidden";this.isInvisible=!1;this.resetActors();
this.removeBehaviorsThatCameFromReacts()};this.makeInvisible();this.makeOthersInvisible=function(){for(var a=window.animation.textIsDisplaying,b=window.animation.loadedScenes.length-1;0<=b;b--)window.animation.loadedScenes[b].id.match(this.id)?this.makeVisible():(window.animation.loadedScenes[b].makeInvisible(),window.animation.loadedScenes[b].hideText());a||this.alwaysShowsText?this.showText():this.hideText();window.animation.textIsDisplaying=a};this.mute=function(){for(var a=0;a<this.actors.length;a++)try{this.actors[a].pauseAudio()}catch(b){}};
this.muteOthers=function(){for(var a=window.animation.loadedScenes.length-1;0<=a;a--)window.animation.loadedScenes[a].id.match(this.id)||window.animation.loadedScenes[a].mute()};this.createActor=function(a,b,f,g,e){a=new Actor(a,b,f,g,e);a.scene=this;this.actors.push(a);return a};this.enterActors=function(){for(var a=0;a<this.actors.length;a++)this.actors[a].enter(this)};this.putOnStage=function(a){a.appendChild(this.div);a.scene=this;this.stage=a;this.dimensions={x:parseInt(a.style.width),y:parseInt(a.style.height)};
this.div.style.width=this.dimensions.x+"px";this.div.style.height=this.dimensions.y+"px";for(a=0;a<window.stage.scene.actors.length;a++)this.actors[a].enter(this)};this.write=function(a,b,f,g){var e=document.createElement("div");e.innerHTML=f;e.setAttribute("class","text "+("undefined"===typeof g?"":g));e.style.left=a+"px";e.style.top=b+"px";this.div.appendChild(e);this.texts.push(e)};this.showText=function(){this.textDisplaying=!0;for(var a=this.texts.length-1;0<=a;a--)this.texts[a].style.visibility=
"visible";window.animation.textIsDisplaying=!0};this.hideText=function(){this.textDisplaying=!1;for(var a=this.texts.length-1;0<=a;a--)this.texts[a].style.visibility="hidden";window.animation.textIsDisplaying=!1};return this};function Appearing(a,b,c,d,f){a=new Plugin(0,0,a,d,f);a.newOpacity=0;a.opacityStep=0;a.appearLength=c;a.reset=function(){this.resetPlugin();this.targetObject.setInitialOpacity(0);this.newOpacity=0;this.opacityStep=60/this.appearLength};a.reset();a.applybehavior=function(){!this.done&&this.targetObject.age()>b&&(this.targetObject.setVisible(),this.newOpacity=this.newOpacity.addUntilTarget(this.opacityStep,1),this.targetObject.alterOpacity(this.newOpacity),this.isDoneWhen(1<=this.targetObject.currentOpacity))};
return a}Actor.prototype.appears=function(a,b,c,d){a=new Appearing(this,a,b,c,d);"undefined"!==typeof c&&(a.triggeredByAction=c);this.addBehavior(a)};Actor.prototype.appearsOnTouch=function(a){this.setInitialOpacity(0);this.reacts("this.appears(0,"+a+", true, reactionTargetIndex);",1)};Actor.prototype.letsAppearStartsVisible=function(a,b){this.reacts("this.appears(0, "+floatValueOfOr(b,1E3)+", true, reactionTargetIndex);",1,a)};
Actor.prototype.letsAppear=function(a,b,c){a.setInvisible();this.letsAppearStartsVisible(a,b,c)};function ChangingImageSrc(a,b,c,d){a=new Plugin(0,0,a,c,d);a.applybehavior=function(){this.targetObject.changeImageSrc(b)};return a}Actor.prototype.changesImageSrc=function(a,b,c){this.addBehavior(new ChangingImageSrc(this,a,b,c))};Actor.prototype.changesImageSrcOnTouch=function(a){this.reacts("this.changesImageSrc('"+a+"', true, reactionTargetIndex);",1)};Actor.prototype.letsChangeImageSrc=function(a,b){this.reacts("this.changesImageSrc('"+b+"', true, reactionTargetIndex);",1,a)};function movementCloning(a,b,c,d,f,g){a=new Plugin(0,0,a,f,g);a.parentActor=b;a.distanceX=c;a.distanceY=d;a.actor.position=a.parentActor.position;a.applybehavior=function(){this.targetObject.vector.x=this.parentActor.vector.x;this.targetObject.vector.y=this.parentActor.vector.y};return a}Actor.prototype.clonesMovement=function(){this.addBehavior(new Drifting(this,forceX,forceY,triggeredByAction,reactionTargetIndex))};
Actor.prototype.clonesMovementOnTouch=function(a,b){this.reacts("this.clonesMovement("+a+","+b+", true, reactionTargetIndex);",1)};Actor.prototype.letsDrift=function(a,b,c){this.reacts("this.clonesMovement("+b+","+c+", true, reactionTargetIndex);",1,a)};function MovementCloning(a,b,c,d,f,g){a=new Plugin(0,0,a,f,g);a.parentActor=b;a.counter=0;a.distanceX=c;a.distanceY=d;a.applybehavior=function(){this.targetObject.position.x=this.parentActor.position.x+this.distanceX;this.targetObject.position.y=this.parentActor.position.y+this.distanceY;this.targetObject.image.style.left=this.targetObject.position.x+"px";this.targetObject.image.style.top=this.targetObject.position.y+"px";20>this.counter&&this.counter++};return a}
Actor.prototype.clonesMovement=function(a,b,c,d,f){this.addBehavior(new MovementCloning(this,a,b,c,d,f))};function Counting(a,b,c,d){a=new Plugin(0,0,a,c,d);"undefined"===typeof a.targetObject&&(a.targetObject=a.actor);a.targetObject.counter+=b;l("counter set to "+a.targetObject.counter);a.targetObject.counterDiv.innerHTML=a.targetObject.counter;a.targetObject.counterDiv.position=a.targetObject.position;a.reset=function(){this.resetPlugin();this.targetObject.counterDiv.position=this.targetObject.position;this.targetObject.counterDiv.style.left=this.targetObject.position.x+"px";this.targetObject.counterDiv.style.top=
this.targetObject.position.y+"px"};a.reset();a.applybehavior=function(){this.targetObject.counterDiv.style.left=this.targetObject.position.x+"px";this.targetObject.counterDiv.style.top=this.targetObject.position.y+"px"};return a}Actor.prototype.counts=function(a,b,c){this.addBehavior(new Counting(this,a,b,c))};
Actor.prototype.letsCount=function(a,b){a.counter=0;a.counterDiv=document.createElement("div");a.counterDiv.setAttribute("class","counter");a.counterDiv.innerHTML=0;a.scene.div.appendChild(a.counterDiv);a.counterDiv.style.left=a.position.x+"px";a.counterDiv.style.top=a.position.y+"px";a.counterDiv.style.pointerEvents="none";a.counterDiv.style.zIndex=1E5;a.counts(0,!1,0);this.reacts("this.counts("+b+", true, reactionTargetIndex);",0,a)};function CountResetter(a,b,c){a=new Plugin(0,0,a,b,c);a.reset=function(){this.resetPlugin();this.targetObject.counter=0;this.targetObject.addsToCounter(0)};a.reset();return a}Actor.prototype.letsCount=function(a,b){a.addBehavior(new CountResetter(a));a.counter=0;a.addsToCounter(0);this.reacts("this.addsToCounter("+b+", true, reactionTargetIndex);",0,a)};
Actor.prototype.addsToCounter=function(a,b,c){b=b?this.reactionTargets[c]:this;b.counter+=a;"undefined"===typeof b.hasTextDiv?b.setText(b.counter):0<=b.originalText.indexOf("%count%")?b.setText(b.originalText.replace("%count%",b.counter)):b.setText(b.counter)};
Actor.prototype.multipliesCounter=function(a,b,c){b=b?this.reactionTargets[c]:this;b.counter*=a;"undefined"===typeof b.hasTextDiv?b.setText(b.counter):0<=b.originalText.indexOf("%count%")?b.setText(b.originalText.replace("%count%",b.counter)):b.setText(b.counter)};Actor.prototype.letsMultiply=function(a,b){a.counter=0;this.reacts("this.multipliesCounter("+b+", true, reactionTargetIndex);",0,a)};function Dissolving(a,b,c,d,f){var g=new Plugin(0,0,a,d,f);g.originalOpacity=a.currentOpacity;g.originalVisibility=a.image.style.visibility;g.startAfter=b;g.newOpacity=0;g.opacityStep=60/c;g.reset=function(){this.resetPlugin();this.newOpacity=this.originalOpacity;this.actor.image.style.visibility=g.originalVisibility;l("dissolving.originalVisibility: "+g.originalVisibility)};g.reset();g.applybehavior=function(){!this.done&&this.targetObject.age()>this.startAfter&&(this.newOpacity=this.newOpacity.subtractUntilZero(this.opacityStep),
this.targetObject.alterOpacity(this.newOpacity),this.isDoneWhen(0>=this.newOpacity&&0>=this.targetObject.currentOpacity),this.done&&this.targetObject.setInvisible())};return g}Actor.prototype.dissolves=function(a,b,c,d){a=new Dissolving(this,a,b,c,d);"undefined"!==typeof c&&(a.triggeredByAction=c);this.addBehavior(a)};Actor.prototype.dissolvesOnTouch=function(a){this.reacts("this.dissolves(0, "+floatValueOfOr(a,1E3)+", true, reactionTargetIndex);",1)};
Actor.prototype.letsDissolve=function(a,b){this.reacts("this.dissolves(0, "+floatValueOfOr(b,1E3)+", true, reactionTargetIndex);",1,a)};function Drifting(a,b,c,d,f){a=new Plugin(0,0,a,d,f);a.reset=function(){this.resetPlugin();this.force={x:b,y:c}};a.reset();a.applybehavior=function(){this.targetObject.vector.x+=this.force.x;this.targetObject.vector.y+=this.force.y};return a}Actor.prototype.drifts=function(a,b,c,d){this.addBehavior(new Drifting(this,a,b,c,d))};Actor.prototype.driftsOnTouch=function(a,b){this.reacts("this.drifts("+a+","+b+", true, reactionTargetIndex);",1)};
Actor.prototype.letsDrift=function(a,b,c){this.reacts("this.drifts("+b+","+c+", true, reactionTargetIndex);",1,a)};function Cloning(){}Actor.prototype.clones=function(){this.addBehavior(new Drifting(this,forceX,forceY,triggeredByAction,reactionTargetIndex))};Actor.prototype.clonesOnTouch=function(a,b){this.reacts("this.clones("+a+","+b+", true, reactionTargetIndex);",1)};Actor.prototype.letsDrift=function(a,b,c){this.reacts("this.clones("+b+","+c+", true, reactionTargetIndex);",1,a)};function HavingText(a,b,c,d,f,g){var e=new Plugin(0,0,a,f,g);e.targetObject.originalText=String(b);e.targetObject.hasTextDiv=document.createElement("div");e.targetObject.hasTextDiv.setAttribute("id",c);e.targetObject.hasTextDiv.setAttribute("class","hastext "+d);e.targetObject.hasTextDivInner=document.createElement("div");e.targetObject.hasTextDivInner.setAttribute("class","inner");e.targetObject.hasTextDiv.appendChild(e.targetObject.hasTextDivInner);e.targetObject.hasTextDiv.style.zIndex="2";e.targetObject.hasTextDiv.style.width=
e.targetObject.imagesize.x+"px";e.targetObject.hasTextDiv.style.height=e.targetObject.imagesize.y+"px";e.targetObject.hasTextDiv.style.pointerEvents="none";e.targetObject.scene.div.appendChild(e.targetObject.hasTextDiv);e.targetObject.hasTextDivInner.innerHTML=b;e.applybehavior=function(){e.targetObject.hasTextDiv.style.visibility=e.targetObject.image.style.visibility;e.targetObject.hasTextDiv.style.left=e.targetObject.position.x+"px";e.targetObject.hasTextDiv.style.top=e.targetObject.position.y+
"px";e.targetObject.hasTextDiv.style.opacity=e.targetObject.currentOpacity;e.targetObject.hasTextDiv.style.transform="rotate("+e.targetObject.tilt+"deg)";e.targetObject.hasTextDiv.style.webkitTransform="rotate("+e.targetObject.tilt+"deg)";e.targetObject.hasTextDiv.style.msTransform="rotate("+e.targetObject.tilt+"deg)";e.targetObject.hasTextDiv.style.OTransform="rotate("+e.targetObject.tilt+"deg)"};return e}
Actor.prototype.setText=function(a,b,c,d,f){"undefined"===typeof this.hasTextDiv?this.addBehavior(new HavingText(this,a,b,c,d,f)):this.hasTextDivInner.innerHTML=a};function Linking(a,b){this.actor=a;this.url=b;/iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?bindEvent(this.actor.image,"touchstart",function(){this.gotourl()}):bindEvent(this.actor.image,"mousedown",function(){this.gotourl()});this.actor.image.gotourl=function(){this.removeEventListener("mousedown",arguments.callee,!1);location.href=b};this.actor.image.style.cursor="pointer";this.applybehavior=function(){}}Actor.prototype.links=function(a){this.addBehavior(new Linking(this,a))};function Moving(a,b,c,d,f,g,e){var h=new Plugin(g,e);h.actor=a;h.force={x:b,y:c};h.speed={x:0,y:0};h.friction=d;h.gravitation=f;h.triggeredByTouch=!1;h.reset=function(){this.resetPlugin();h.speed={x:0,y:0};h.force={x:b,y:c}};h.reset();h.applybehavior=function(){1!=this.factor()&&(console.log("this.factor(): "+this.factor()),console.log("this.age(): "+this.age()));h.force.x*=0.9;h.force.y*=0.9;"undefined"!=typeof h.gravitation&&(h.force.y+=h.gravitation/50);h.speed.x+=h.force.x;h.speed.y+=h.force.y;
"undefined"!=typeof h.friction&&(h.speed.x*=1-h.friction/50,h.speed.y*=1-h.friction/50);h.actor.vector.x+=h.speed.x*this.factor();h.actor.vector.y+=h.speed.y*this.factor()};return h}Actor.prototype.moves=function(a,b,c,d,f,g){this.addBehavior(new Moving(this,a,b,c,d,f,g))};
Actor.prototype.movesOnTouch=function(a,b,c,d,f,g){a=a+","+b;"undefined"!=typeof c&&(a+=", "+c);"undefined"!=typeof d&&(a+=", "+d);"undefined"!=typeof f&&(a+=", "+f);"undefined"!=typeof g&&(a+=", "+g);this.reacts("this.moves("+a+");")};function MovingTo(a,b,c,d,f,g,e){var h=new Plugin(0,0.5);h.triggeredByAction=g;h.actor=a;h.targetObject=isNumeric(e)?a.reactionTargets[e]:a;h.reset=function(){this.force={x:d,y:f};this.finishedMovingTo=!1};h.reset();h.applybehavior=function(){if(!this.finishedMovingTo){var a=vector(this.targetObject.position.x,this.targetObject.position.y,b,c);2<a.distance?(this.targetObject.vector.x+=this.force.x*a.x,this.targetObject.vector.y+=this.force.y*a.y):this.finishedMovingTo=!0}};return h}
Actor.prototype.movesTo=function(a,b,c,d,f,g){for(var f="undefined"===typeof f?!1:f,e=this.behaviors.length-1;0<=e;e--)try{this.behaviors[e].finishedMovingTo=!0}catch(h){}for(e=this.scene.actors.length-1;0<=e;e--)for(var i=0;i<this.scene.actors[e].behaviors.length;i++)try{this.scene.actors[e].reactionTargets[i].filename===this.filename&&(this.scene.actors[e].behaviors[i].finishedMovingTo=!0,l("finished"))}catch(j){l("not applicable")}a=new MovingTo(this,a,b,c,d,f,g);this.addBehavior(a)};
Actor.prototype.movesToOnTouch=function(a,b,c,d){this.reacts("this.movesTo("+a+","+b+","+c+","+d+", true, reactionTargetIndex);",1)};Actor.prototype.letsMoveTo=function(a,b,c,d,f){this.reacts("this.movesTo("+b+","+c+","+d+","+f+", true, reactionTargetIndex);",1,a)};Actor.prototype.movesToOnTouch=function(a,b,c,d){this.reacts("this.movesTo("+a+","+b+","+c+","+d+", true, reactionTargetIndex);",1)};function Multichoicing(a,b,c){a=new Plugin(0,0,a,b,c);a.reset=function(){this.resetPlugin()};a.reset();a.applybehavior=function(){};return a}Actor.prototype.multichoices=function(a,b){this.addBehavior(new Multichoicing(this,a,b))};
Actor.prototype.isQuestion=function(a,b,c,d,f,g,e,h){this.rightanswers=a;this.wronganswers=b;c.setInvisible();for(var i=a.length-1;0<=i;i--){h?a[i].letsAppear(c,1):a[i].letsAppearAsQuestion(c,1);a[i].letsChangeImageSrc(this,d);a[i].plays(g,d);a[i].letsChangeImageSrc(a[i],d);a[i].setInvisible();for(i=b.length-1;0<=i;i--)a[i].letsDissolve(b[i])}for(i=b.length-1;0<=i;i--)b[i].setInvisible();for(i=b.length-1;0<=i;i--)b[i].letsChangeImageSrc(b[i],f),b[i].plays(e,f)};
Actor.prototype.isLastQuestion=function(a,b,c,d,f,g,e){this.isQuestion(a,b,c,d,f,g,e,!0)};function AppearingAsQuestion(a,b,c){a=Plugin(0,0,a,b,c);a.targetObject.setVisible();for(b=a.targetObject.rightanswers.length-1;0<=b;b--)a.targetObject.rightanswers[b].setVisible();for(b=a.targetObject.wronganswers.length-1;0<=b;b--)a.targetObject.wronganswers[b].setVisible();return a}Actor.prototype.appearsAsQuestion=function(a,b){this.addBehavior(new AppearingAsQuestion(this,a,b))};
Actor.prototype.letsAppearAsQuestion=function(a){this.reacts("this.appearsAsQuestion(true, reactionTargetIndex);",1,a)};Actor.prototype.passesTouchThrough=function(){this.image.style.pointerEvents="none"};function Playing(a,b,c,d,f,g){var e=new Plugin(0,0);e.actor=a;e.actor.playingImagePath="images/"+c;e.actor.waitingImagePath=e.actor.image.src;e.actor.playLooped=d;e.actor.playOnLoad=f;e.actor.playOnLoadExecuted=!1;e.reset=function(){e.actor.playOnLoadExecuted=!1;e.actor.audioplaying=!1};e.reset();e.applybehavior=function(){this.actor.playOnLoad&&!this.actor.playOnLoadExecuted&&(this.actor.playOnLoadExecuted=!0,this.actor.toggleAudio())};e.actor.showPlayingImage=function(){this.image.src=this.playingImagePath};
e.actor.showWaitingImage=function(){this.image.src=this.waitingImagePath};e.actor.audio=document.createElement("audio");a=document.createElement("source");e.actor.audio.canPlayType("audio/mpeg;")?(a.type="audio/mpeg",a.src="audio/"+b+".mp3"):(a.type="audio/ogg",a.src="audio/"+b+".ogg");e.actor.audio.appendChild(a);e.actor.audio.actor=e.actor;"undefined"===typeof g&&(g=0);e.actor.audio.betweenLoops=g;l(e.actor.audio.betweenLoops);e.actor.playLooped?bindEvent(e.actor.audio,"ended",function(){e.actor.showWaitingImage(this.actor);
e.actor.showWaitingImage(this.actor);setTimeout(function(){e.actor.audioplaying&&e.actor.toggleAudio("play")},e.actor.audio.betweenLoops)}):bindEvent(e.actor.audio,"ended",function(){e.actor.showWaitingImage(this.actor);e.actor.audioplaying=!1});e.actor.toggleAudio=function(a){"play"===a?this.playAudio():"pause"==a?this.pauseAudio():this.audioplaying?this.pauseAudio():this.playAudio()};e.actor.playAudio=function(){l("playing");this.audio.currentTime&&(this.audio.currentTime=0);this.audio.play();this.showPlayingImage();
this.audioplaying=!0};e.actor.pauseAudio=function(){l("pause");this.audio.pause();this.audioplaying=!1;this.showWaitingImage()};e.actor.reacts("this.toggleAudio();");return e}Actor.prototype.playsOnLoad=function(a,b){var c=this,d=new Playing(c,a,b,!1,!0);setTimeout(function(){c.addBehavior(d)},500)};Actor.prototype.plays=function(a,b){var c=this;setTimeout(function(){c.addBehavior(new Playing(c,a,b,!1,!1))},500)};
Actor.prototype.playsLoop=function(a,b,c){var d=this,f=new Playing(d,a,b,!0,!1,c);setTimeout(function(){d.addBehavior(f)},500)};Actor.prototype.playsLoopOnLoad=function(a,b,c){var d=this,f=new Playing(d,a,b,!0,!0,c);setTimeout(function(){d.addBehavior(f)},500)};Actor.prototype.playsAndPulsates=function(a,b){var c=this,d=new Playing(c,a,b);c.pulsatesWhilePlaying=!0;setTimeout(function(){c.addBehavior(d)},500)};function Pulsating(a,b,c,d,f,g){var e=new Plugin(0,0,a,f,g);if("undefined"===typeof d||notNumeric(d))d=0;var h=1,i=1,j="up",k=0,m=!1;e.applybehavior=function(){if(0==d||k<=d)i=h,h=1+c/10*Math.sin(2*(new Date-this.startAnimationTimestamp)*b/500),i<h&&"down"===j?j="up":i>h&&"up"===j&&(j="down",m=!1),e.targetObject.image.style.webkitTransform="scale("+h+", "+h+")",!m&&("up"===j&&1<h)&&(k++,m=!0)};return e}Actor.prototype.pulsates=function(a,b,c,d,f){a=new Pulsating(this,a,b,c,d,f);this.addBehavior(a)};
Actor.prototype.pulsatesOnTouch=function(a,b,c,d){this.reacts("this.pulsates("+a+", "+b+", "+c+", true, reactionTargetIndex);",d)};Actor.prototype.letsPulsate=function(a,b,c,d,f){this.reacts("this.pulsates("+b+", "+c+", "+d+", true, reactionTargetIndex);",f,a)};function Reacting(a,b,c){var d=new Plugin(0,0);d.actor=a;d.actor.action=b;"undefined"!=typeof c&&(c="images/"+c,document.createElement("img").setAttribute("src",c),d.actor.image.actionimagepath=c);a=/iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?"touchstart":"mousedown";bindEvent(d.actor.image,a,function(){changeImageAndReact.call(d.actor.image)});d.actor.image.style.cursor="pointer";return d}
function changeImageAndReact(){if("undefined"!=typeof this.actionimagepath&&(this.originalimagepath=this.src,this.src=this.actionimagepath,"undefined"!=typeof actionimagelength&&0<parseInt("0"+actionimagelength))){var a=this;window.setTimeout(function(){parseInt(a.src=a.originalimagepath)},200)}eval(this.actor.action)}Actor.prototype.reacts=function(a,b,c){this.addBehavior(new Reacting(this,a,b,c))};Actor.prototype.triggerResetReactions=function(a,b){l("triggering reset action on "+this.reactionTargets[b].filename);this.reactionTargets[b].resetReactions()};Actor.prototype.letsResetReactions=function(a){this.reacts("this.triggerResetReactions(true, reactionTargetIndex)",1,a)};function Rotating(a,b,c,d){a=new Plugin(0,0,a,c,d);a.spin=6*b;a.applybehavior=function(){this.targetObject.spin+=this.spin};return a}Actor.prototype.rotates=function(a,b,c){a=new Rotating(this,a,b,c);this.addBehavior(a)};Actor.prototype.rotatesOnTouch=function(a,b){this.reacts("this.rotates("+a+", true, reactionTargetIndex);",b)};Actor.prototype.letsRotate=function(a,b,c){this.reacts("this.rotates("+b+", true, reactionTargetIndex);",c,a)};function Shaking(a,b,c,d,f,g){f=new Plugin(0,0,a,f,g);f.reset=function(){this.peak={x:b/2,y:c/2};this.hertz=d;this.actor=a;this.force={x:0,y:0};this.shakingStartedAt=null};f.applybehavior=function(){null===typeof this.shakingStartedAt&&(this.shakingStartedAt=now());this.tmpValue=Math.sin((this.shakingStartedAt-now())*this.hertz/250);"undefined"!=typeof this.lastTmpValue&&(this.targetObject.vector.x+=(this.lastTmpValue-this.tmpValue)*this.peak.x,this.targetObject.vector.y+=(this.lastTmpValue-this.tmpValue)*
this.peak.y);this.lastTmpValue=this.tmpValue};return f}Actor.prototype.shakes=function(a,b,c,d,f){this.addBehavior(new Shaking(this,a,b,c,d,f))};Actor.prototype.shakesOnTouch=function(a,b,c,d){this.reacts("this.shakes("+a+","+b+","+c+");","undefined"===typeof d?1:d)};Actor.prototype.letsShake=function(a,b,c,d,f){this.reacts("this.shakes("+b+","+c+","+d+", true, reactionTargetIndex\t);","undefined"===typeof f?1:f,a)};function Swinging(a,b,c,d,f,g,e){var a=new Plugin(0,0,a,g,e),h=0,i=0;a.applybehavior=function(){i=Math.sin(new Date*c/1E3);h=i*b;this.actor.image.style.webkitTransformOrigin=d+"px "+f+"px";this.actor.image.style.webkitTransform="rotate("+h/2+"deg)"};return a}Actor.prototype.swings=function(a,b,c,d,f,g){this.addBehavior(new Swinging(this,a,b,c,d,f,g))};function togglesText(a){this.reset=function(){this.force={x:forceX,y:forceY}};this.reset();this.applybehavior=function(){a.vector.x+=this.force.x;a.vector.y+=this.force.y}}Actor.prototype.toggle=function(){this.scene.textDisplaying?(this.image.src="images/"+this.textToggleAlternativeImagePath,this.scene.hideText()):(this.image.src="images/"+this.image.originalPath,this.scene.showText())};Actor.prototype.togglesTextOnTouch=function(a){this.textToggleAlternativeImagePath=a;this.reacts("this.toggle();")};function Waving(a,b,c,d,f,g,e){g=new Plugin(0,0,a,g,e);g.reset=function(){this.actor=a;this.hertz=c;this.radius=b};g.applybehavior=function(){"undefined"===typeof this.wavingStartedAt&&(this.wavingStartedAt=now());this.skew=Math.sin((this.wavingStartedAt-now())*this.hertz/1E3)*this.radius;this.actor.image.style.webkitTransformOrigin=d+"px "+f+"px";this.actor.image.style.webkitTransform="skew("+this.skew+"deg, 0deg)";this.actor.image.style.transformOrigin=d+"px "+f+"px";this.actor.image.style.transform=
"skew("+this.skew+"deg, 0deg)";this.actor.image.style.msTransformOrigin=d+"px "+f+"px";this.actor.image.style.msTransform="skew("+this.skew+"deg, 0deg)";this.actor.image.style.OTransformOrigin=d+"px "+f+"px";this.actor.image.style.OTransform="skew("+this.skew+"deg, 0deg)"};return g}Actor.prototype.waves=function(a,b,c,d){this.addBehavior(new Waving(this,a,b,c,d))};
